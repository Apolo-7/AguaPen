<div class="formgroup-inline">
    

  
    <div class="field">
      <label for="dropdown" class="p-sr-only">Seleccionar Area:</label>
      <p-iconField iconPosition="left">
        <p-inputIcon styleClass="pi pi-user" />
        <p-dropdown
          id="dropdown"
          [options]="dropdownOptions"
          [(ngModel)]="selectedArea"
          optionLabel="nombre_area"
          [filter]="true"
          filterBy="nombre_area"
          [showClear]="true"
          placeholder="Seleccionar o escribir Área"
          (onChange)="selectArea($event)"
        >
          <ng-template let-area pTemplate="item">
            <div class="flex align-items-center gap-2">
              <div>{{ area.nombre_area }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </p-iconField>
    </div>
  </div>
  
  @if (selectedArea) {
  <div>
    <p-card class="user-card">
      <ng-template pTemplate="header">
        <div class="header-content">
          <span class="pi pi-user card-icon"></span>
          <span>Area</span>
        </div>
      </ng-template>
      <ng-template pTemplate="content">
        <div class="field">
          <label>Nombre:</label>
          <span>{{ selectedArea.nombre_area }}</span>
        </div>
       
    
      </ng-template>
      <ng-template pTemplate="footer">
        <div class="flex justify-content-end">
          <button
            pButton
            type="button"
            icon="pi pi-plus"
            label="Asignar Productos"
            class="p-mr-2"
            (click)="toggleProducts()"
          ></button>
          &nbsp;
          <button
            pButton
            type="button"
            label="Realizar Registro"
            (click)="register()"
          ></button>
        </div>
      </ng-template>
    </p-card>
  </div>
  } @if (showProductsTable ) { &nbsp;
  <div>
    <div class="card flex flex-wrap justify-content-center gap-3">
      <p-iconField iconPosition="left">
        <p-inputIcon styleClass="pi pi-book" />
  
        <input
          type="text"
          pInputText
          placeholder="Agregar Nota"
          [(ngModel)]="observacion"
        />
      </p-iconField>
  
      <p-iconField iconPosition="left">
        <p-inputIcon styleClass="pi pi-search" />
  
        <input
          type="text"
          pInputText
          placeholder="Buscar por nombre"
          [(ngModel)]="searchTerm"
        />
      </p-iconField>
    </div>
    <div>
      &nbsp;
      <p-table [value]="filterProducts(searchTerm)">
        <ng-template pTemplate="header">
          <tr>
            <th>Nombre del Producto</th>
            <th>Stock</th>
            <th>Acción</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-producto>
          <tr>
            <td>{{ producto.nombre_producto }}</td>
            <td>{{ producto.stock_producto }}</td>
            <td>
              @if (isProductSelected(producto)) {
  
              <ng-container>
                <span>{{ producto.cantidad }} agregado(s)</span>
                <button
                  pButton
                  type="button"
                  icon="pi pi-undo"
                  class="p-button-rounded p-button-warning p-button-outlined"
                  (click)="revertProduct(producto)"
                ></button>
              </ng-container>
  
              } @else {
              <ng-container>
                <button
                  pButton
                  type="button"
                  icon="pi pi-minus"
                  class="p-button-rounded p-button-secondary p-button-outlined"
                  (click)="decrement(producto)"
                ></button>
                <input
                  type="number"
                  pInputText
                  [(ngModel)]="producto.cantidad"
                  [min]="1"
                  [max]="producto.stock_producto"
                  style="width: 60px; margin: 0 8px"
                />
                <button
                  pButton
                  type="button"
                  icon="pi pi-plus"
                  class="p-button-rounded p-button-secondary p-button-outlined"
                  (click)="increment(producto)"
                ></button>
                <button
                  pButton
                  type="button"
                  icon="pi pi-check"
                  class="p-button-rounded p-button-success p-button-outlined"
                  (click)="addProduct(producto)"
                  [disabled]="
                    producto.cantidad > producto.stock_producto ||
                    producto.cantidad < 1
                  "
                ></button>
              </ng-container>
              }
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
  }
  
  <!-- Componente de carga -->
  <p-blockUI [blocked]="loading">
    <div class="loading-container p-d-flex p-jc-center p-ai-center p-flex-column">
      <p>{{ loadingMessage }}</p>
  
      <p-progressSpinner
        ariaLabel="loading"
        styleClass="w-4rem h-4rem"
        strokeWidth="8"
        fill="var(--surface-ground)"
      >
      </p-progressSpinner>
    </div>
  </p-blockUI>
  
  <p-toast
    [breakpoints]="{ '920px': { width: '100%', right: '0', left: '0' } }"
  ></p-toast>
  